@page "/company"
@using SkinApi.Gui.Clients;
@inject ISkinApiClient SkinApiClient;

<PageTitle>View Companies</PageTitle>
<MudText Typo="Typo.h3" GutterBottom="true">View Companies</MudText>

<MudTable Items="@companies" Hover="true" Breakpoint="Breakpoint.Sm" Loading="@loading" LoadingProgressColor="Color.Info">
    <HeaderContent>
        <MudTh>Id</MudTh>
        <MudTh>Name</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd DataLabel="Id" >@context.CompanyID</MudTd>
        <MudTd DataLabel="Azioni" Style="text-align:right">
            <MudButton Variant="Variant.Filled" DisableElevation="true" Color="Color.Primary" Size="Size.Small" OnClick="@((e) => SelectCompany(context.CompanyID.Value))"><strong>Apri</strong></MudButton>
        </MudTd>    
    </RowTemplate>
</MudTable>

@code {
    private IEnumerable<CompanyRecord> companies = new List<CompanyRecord>();
    private bool loading = true;

    protected override async Task OnInitializedAsync()
    {
        companies = await SkinApiClient.GetCompaniesAsync();
        loading = false;
    }

    private async void SelectCompany(int CompanyId)
    {
        
        
        //use some sort of Mudblazor popup menu, update data, post to database.
    }

}